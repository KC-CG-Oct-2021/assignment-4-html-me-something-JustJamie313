<!DOCTYPE html>
<html lang='en'>
    <head>
        <title>KC CoderGirl Art Gallery - ViewFinder</title>
        <link rel='stylesheet' type='text/css' href='viewFinder.css'/>
        <link rel='icon' type='image/x-icon' href='../images/viewfinder.png'/>
        <script src='../gallery.js'></script>
    </head>
    <body onkeydown='if(event.key === "ArrowUp"){look(0);}if(event.key === "ArrowRight"){look(1);}'>
        <div class='containerBG fade transparent'></div>
        <div class='container' onmousedown='if(window.ontouchend==undefined&&navigator.maxTouchPoints==0){look(event.button)}'>
            <img id='leftEye' class='fade full'/>
            <img id='leftDisc' class='disc fade transparent'/>
            <img id='centerDisc' class='disc fade transparent'/>
            <img id='rightDisc' class='disc fade transparent'/>
            <img id='rightEye' class='fade full'/>
        </div>
        <div class='buttonBox'>
            <button id='view' onclick='look(0);'>View</button>
            <button id='advance' onclick='look(1);'>Next</button>
            <button id='help' onclick='showControls();'>?</button>
        </div>
        <div class="controls">
            <span class='close' onclick='showControls();' onmousedown='this.style.boxShadow="none";' onmouseout='this.style.boxShadow="0px 0px 5px black"'>X</span>
            <h5>Touch-Screen Controls</h5>
            <p>
                Touch the ViewFinder with <b>ONE FINGER</b> to View or Stop Viewing the image(or use on-screen controls).<br/>
                Touch the ViewFinder with <b>TWO FINGERS</b> to advance to the next image (this will sometimes cause the View/Stop Viewing process to run if both fingers don't touch at exactly the same time).
            </p>
            <h5>Keyboard Controls</h5>
            <p>
                Press <b>Up Arrow</b> to View or Stop Viewing the image.<br/>
                Press <b>Right Arrow</b> to advance to the next image.
            </p>
            <h5>Mouse Controls</h5>
            <p>
                Click the <b>LEFT</b> mouse button to View or Stop Viewing the image.<br/>
                Click the <b>MIDDLE</b> mouse button to advance to the next image.
            </p>
            <h5>On-Screen Controls</h5>
            <p>
                Click the <b>View/Stop Viewing</b> Button to View or Stop Viewing the image.<br/>
                Click the <b>Next</b> Button to advance to the next image.
            </p>
        </div>
        
        <footer>
            <p>Version: 2.15</p>
            &copy; <script>document.write(new Date().getFullYear())</script> <b>&#183;</b> Jamie Miller ~ All Rights Reserved.
            <p>All images and poetry are my original works.  All Rights Reserved.</p>
         </footer>
    </body>
    <script>
        document.querySelector('.container').addEventListener('touchstart',function(e){
            let changed = false;
            switch(e.touches.length){
                case 2:
                    look(1);
                    changed = true;
                break;
                default:
                    if(!changed){
                        look(0);
                    }
            }
        });
        let index = Number(location.href.substring(location.href.indexOf('=')+1));
        if(!index){index=Math.floor(Math.random()*gallery.length);}
        let leftEye = document.querySelector('#leftEye');
        let rightEye = document.querySelector('#rightEye');
        let discs = document.querySelectorAll('.disc');
        loadImages(index);
        function loadImages(index){
            discs[0].src = `../images/${index+3>gallery.length-1?gallery[index+3-(gallery.length)].src:gallery[index+3].src}`;
            discs[0].alt = `${index+3>gallery.length-1?gallery[index+3-(gallery.length)].alt:gallery[index+3].alt}`;
            discs[1].src = `../images/${index+2>gallery.length-1?gallery[index+2-(gallery.length)].src:gallery[index+2].src}`;
            discs[1].alt = `${index+2>gallery.length-1?gallery[index+2-(gallery.length)].alt:gallery[index+2].alt}`;
            discs[2].src = `../images/${index+1>gallery.length-1?gallery[index+1-(gallery.length)].src:gallery[index+1].src}`;
            discs[2].alt = `${index+1>gallery.length-1?gallery[index+1-(gallery.length)].alt:gallery[index+1].alt}`;
            leftEye.src = `../images/${gallery[index].src}`;
            leftEye.alt = `${gallery[index].alt}`;
            rightEye.src = `../images/${gallery[index].src}`;
            rightEye.alt = `${gallery[index].alt}`;
        }
        function look(button){
            switch(button){
                case 0:
                    runFade();
                    changeButton();
                break;
                case 1:
                    changePicture();
                break;
            }
        }
        function runFade(){
            let els = document.querySelectorAll('.fade');
            for(let a=0;a<els.length;a++){
                els[a].style.animationPlayState = 'running';
                els[a].addEventListener('animationiteration',()=>{
                    els[a].style.animationPlayState = 'paused';
                });
            }
        }
        function changePicture(){
            if(index === gallery.length -1){
                index = 0;
            } else {
                index++;
            }
            loadImages(index);
        }
        function changeButton(){
            let button = document.querySelector('#view');
            if(button.innerHTML==="View"){
                button.innerHTML = "Stop Viewing";
            } else {
                button.innerHTML = "View";
            }
        }
        function showControls(){
            let controls = document.querySelector('.controls');
            if(controls.style.display === 'none'){
                controls.style.display = 'flex';
            } else {
                controls.style.display = 'none';
            }
            
        }
    </script>
</html>
